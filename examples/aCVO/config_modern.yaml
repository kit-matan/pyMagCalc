# Modern Configuration for aCVO (H=20T)
# Generated by script based on spin_model_hc.py logic

# 1. Structure
crystal_structure:
  dimensionality: 3
  lattice_vectors:
    - [20.645, 0.0, 0.0]
    - [0.0, 8.383, 0.0]
    - [0.0, 0.0, 6.442]
  atoms_uc:
    - label: V0
      pos: [3.4212894, 3.0564417999999995, 4.860488999999999]
      spin_S: 0.5
    - label: V1
      pos: [17.2237106, 5.326558199999999, 4.860488999999999]
      spin_S: 0.5
    - label: V2
      pos: [3.4212894, 7.2479417999999995, 1.6394889999999998]
      spin_S: 0.5
    - label: V3
      pos: [17.2237106, 1.1350582, 1.6394889999999998]
      spin_S: 0.5
    - label: V4
      pos: [13.743789399999999, 3.0564417999999995, 1.6394889999999998]
      spin_S: 0.5
    - label: V5
      pos: [6.901210600000001, 5.326558199999999, 1.6394889999999998]
      spin_S: 0.5
    - label: V6
      pos: [13.743789399999999, 7.2479417999999995, 4.860488999999999]
      spin_S: 0.5
    - label: V7
      pos: [6.901210600000001, 1.1350582, 4.860488999999999]
      spin_S: 0.5
    - label: V8
      pos: [8.5825394, 7.422308199999999, 6.470988999999999]
      spin_S: 0.5
    - label: V9
      pos: [1.7399605999999999, 5.1521918, 6.470988999999999]
      spin_S: 0.5
    - label: V10
      pos: [8.5825394, 3.2308082, 3.249989]
      spin_S: 0.5
    - label: V11
      pos: [1.7399605999999999, 9.343691799999998, 3.249989]
      spin_S: 0.5
    - label: V12
      pos: [18.9050394, 7.422308199999999, 3.249989]
      spin_S: 0.5
    - label: V13
      pos: [12.0624606, 5.1521918, 3.249989]
      spin_S: 0.5
    - label: V14
      pos: [18.9050394, 3.2308082, 6.470988999999999]
      spin_S: 0.5
    - label: V15
      pos: [12.0624606, 0.9606918000000002, 6.470988999999999]
      spin_S: 0.5
  magnetic_elements: ["V"]

# 2. Parameters
parameters:
  J1: 2.49
  J2: 2.7888000000000006
  J3: 5.0546999999999995
  G1: 0.28
  Dx: 2.67
  H_dir: [1.0, 0.0, 0.0] # Field Direction (H//c)
  H_mag: 6.0 # Field Magnitude
  S: 0.5

# 3. Minimization
minimization:
  enabled: true
  method: "L-BFGS-B"
  maxiter: 5000
  initial_configuration:
    - atom_index: 0
      theta: 1.52 # approx pi/2 - 0.05
      phi: 0.0
    - atom_index: 1
      theta: 1.52
      phi: 3.14159
    - atom_index: 2
      theta: 1.52
      phi: 0.0
    - atom_index: 3
      theta: 1.52
      phi: 3.14159
    - atom_index: 4
      theta: 1.52
      phi: 0.0
    - atom_index: 5
      theta: 1.52
      phi: 3.14159
    - atom_index: 6
      theta: 1.52
      phi: 0.0
    - atom_index: 7
      theta: 1.52
      phi: 3.14159
    - atom_index: 8
      theta: 1.52
      phi: 0.0
    - atom_index: 9
      theta: 1.52
      phi: 3.14159
    - atom_index: 10
      theta: 1.52
      phi: 0.0
    - atom_index: 11
      theta: 1.52
      phi: 3.14159
    - atom_index: 12
      theta: 1.52
      phi: 0.0
    - atom_index: 13
      theta: 1.52
      phi: 3.14159
    - atom_index: 14
      theta: 1.52
      phi: 0.0
    - atom_index: 15
      theta: 1.52
      phi: 3.14159
      
# 3. Interactions
interactions:
  - type: heisenberg
    pair: [V0, V5]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V0, V7]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V0, V9]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V0, V9]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 0
    atom_j: 9
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V0, V11]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V0, V11]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 0
    atom_j: 11
    offset_j: [0, -1, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V1, V4]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V1, V6]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V1, V12]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V1, V12]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 1
    atom_j: 12
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V1, V14]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V1, V14]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 1
    atom_j: 14
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V2, V5]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V2, V11]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V2, V11]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 2
    atom_j: 11
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V2, V9]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V2, V9]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 2
    atom_j: 9
    offset_j: [0, 0, -1]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V2, V7]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V3, V4]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V3, V6]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V3, V12]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V3, V12]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 3
    atom_j: 12
    offset_j: [0, -1, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V3, V14]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V3, V14]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 3
    atom_j: 14
    offset_j: [0, 0, -1]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V4, V1]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V4, V3]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V4, V13]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V4, V13]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 4
    atom_j: 13
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V4, V15]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V4, V15]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 4
    atom_j: 15
    offset_j: [0, 0, -1]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V5, V0]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V5, V2]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V5, V10]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V5, V10]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 5
    atom_j: 10
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V5, V8]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V5, V8]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 5
    atom_j: 8
    offset_j: [0, 0, -1]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V6, V1]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V6, V13]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V6, V13]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 6
    atom_j: 13
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V6, V3]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V6, V15]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V6, V15]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 6
    atom_j: 15
    offset_j: [0, 1, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V7, V0]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V7, V10]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V7, V10]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 7
    atom_j: 10
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V7, V2]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V7, V8]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V7, V8]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 7
    atom_j: 8
    offset_j: [0, -1, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V8, V13]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V8, V5]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V8, V5]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 8
    atom_j: 5
    offset_j: [0, 0, 1]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V8, V7]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V8, V7]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 8
    atom_j: 7
    offset_j: [0, 1, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V8, V15]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V9, V0]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V9, V0]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 9
    atom_j: 0
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V9, V12]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V9, V14]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V9, V2]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V9, V2]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 9
    atom_j: 2
    offset_j: [0, 0, 1]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V10, V5]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V10, V5]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 10
    atom_j: 5
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V10, V7]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V10, V7]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 10
    atom_j: 7
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V10, V13]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V10, V15]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V11, V2]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V11, V2]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 11
    atom_j: 2
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V11, V12]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V11, V14]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V11, V0]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V11, V0]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 11
    atom_j: 0
    offset_j: [0, 1, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V12, V1]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V12, V1]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 12
    atom_j: 1
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V12, V3]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V12, V3]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 12
    atom_j: 3
    offset_j: [0, 1, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V12, V9]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V12, V11]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V13, V4]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V13, V4]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 13
    atom_j: 4
    offset_j: [0, 0, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V13, V6]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V13, V6]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 13
    atom_j: 6
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V13, V8]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V13, V10]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V14, V1]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V14, V1]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 14
    atom_j: 1
    offset_j: [0, 0, 0]
    value: [-2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V14, V3]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V14, V3]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 14
    atom_j: 3
    offset_j: [0, 0, 1]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V14, V11]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V14, V9]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V15, V10]
    distance: 5.2572
    value: "J3"
  - type: heisenberg
    pair: [V15, V6]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V15, V6]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 15
    atom_j: 6
    offset_j: [0, -1, 0]
    value: [2.67, 0.0, 0.0]
  - type: heisenberg
    pair: [V15, V8]
    distance: 3.9751
    value: "J2"
  - type: heisenberg
    pair: [V15, V4]
    distance: 3.1325
    value: "J1"
  - type: anisotropic_exchange
    pair: [V15, V4]
    distance: 3.1325
    value: ["G1", "-G1", "-G1"]
  - type: dm_manual
    atom_i: 15
    atom_j: 4
    offset_j: [0, 0, 1]
    value: [-2.67, 0.0, 0.0]

# 4. Transformations (Fixed for H=20T)
transformations:
  variables:
    theta_c: "-0.1298"
    pi: "3.14159265359"
  atom_frames:
    - atom: 0
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 1
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"
    - atom: 2
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 3
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"
    - atom: 4
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 5
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"
    - atom: 6
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 7
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"
    - atom: 8
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 9
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"
    - atom: 10
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 11
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"
    - atom: 12
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 13
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"
    - atom: 14
      rotation: "Matrix([[0.9915878007119013, -0.0, -0.12943582764959113], [0.0, 1.0, -0.0], [0.12943582764959113, 0.0, 0.9915878007119013]])"
    - atom: 15
      rotation: "Matrix([[0.9915878007119013, -0.0, 0.12943582764959113], [2.069134331808533e-18, 1.0, -1.5851317202606025e-17], [-0.12943582764959113, 1.598579287807466e-17, 0.9915878007119013]])"

# 5. Calculation
calculation:
  cache_mode: 'w'
  cache_file_base: "CVO_modern_cache"

# 6. Q-Path (Custom path: (0,1,0) to (0,3,0))
q_path:
  Start: [0, 1, 0]
  End: [0, 3, 0]
  path: ["Start", "End"]
  points_per_segment: 100

# 7. Output
output:
  disp_data_filename: "../../cache/data/CVO_modern_disp_data.npz"
  sqw_data_filename: "../../cache/data/CVO_modern_sqw_data.npz"

# 8. Plotting
plotting:
  save_plot: true
  disp_plot_filename: "../plots/CVO_modern_disp.png"
  sqw_plot_filename: "../plots/CVO_modern_sqw.png"
  energy_limits_disp: [0, 10]
  energy_limits_sqw: [0, 10]
  disp_title: "aCVO Dispersion (Modern Config)"
  sqw_title: "aCVO S(Q,w) (Modern Config)"
  plot_structure: true # Enable plotting of minimized magnetic structure
  show_plot: false # Set to true to display plots on screen, false to save only

# 9. Tasks
tasks:
  run_minimization: true
  run_dispersion: true
  plot_dispersion: true
  run_sqw_map: true
  plot_sqw_map: true
  calculate_dispersion_new: true
  calculate_sqw_map_new: true
